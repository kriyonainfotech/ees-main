import{r as t,d as W,u as X,j as e,q as Y,s as Z,c as L,B as ee}from"./index-krimXHuz.js";const O="https://ees121.com",ae=()=>{const[z,T]=t.useState([]),[j,f]=t.useState(""),[y,b]=t.useState(""),[v,N]=t.useState(""),[C,S]=t.useState(""),[w,o]=t.useState(""),[k,u]=t.useState(""),[A,m]=t.useState(""),[D,g]=t.useState(""),[se,c]=t.useState("");t.useState("");const[x,q]=t.useState([]),[_,H]=t.useState(""),[E,P]=t.useState(""),[B,U]=t.useState(""),[$,F]=t.useState(!1),[p,I]=t.useState(!1),a=W(),R=X(),G=async()=>{try{const i=(await L.get(`${O}/category/getAllCategory`)).data.category.sort((l,n)=>l.categoryName.localeCompare(n.categoryName));T(i)}catch(s){console.error("Error fetching categories:",s)}};t.useEffect(()=>{var s,i,l,n,d;G(),a!=null&&a.state&&(f(a.state.name||""),b(a.state.email||""),N(a.state.phone||""),o(((s=a.state.address)==null?void 0:s.area)||""),u(((i=a.state.address)==null?void 0:i.city)||""),m(((l=a.state.address)==null?void 0:l.state)||""),g(((n=a.state.address)==null?void 0:n.country)||""),S(((d=a.state.address)==null?void 0:d.pincode)||""),q(a.state.businessCategory||[]),H(a.state.businessName||""),P(a.state.businessAddress||""),U(a.state.businessDetaile||""))},[a]);const J=()=>F(!$),K=s=>{q(s),F(!1)},M=async s=>{try{const l=await(await fetch(`https://api.postalpincode.in/pincode/${s}`)).json();if(l[0].Status==="Success"){const n=l[0].PostOffice[0];o(n.Name||""),u(n.District||""),m(n.State||""),g(n.Country||""),c("")}else c("Invalid Pincode! Please enter a valid one."),h()}catch{c("Failed to fetch location details. Try again later."),h()}},h=()=>{o(""),u(""),m(""),g("")},Q=s=>{const i=s.target.value.trim();S(i),i.length===6?M(i):(h(),c(""))},V=async s=>{var n,d;s.preventDefault();const i={area:w,city:k,state:A,country:D,pincode:C},l={userId:a.state._id,name:j,email:y,phone:v,address:i,businessCategory:x,businessName:_,businessAddress:E,businessDetaile:B};I(!0);try{const r=await L.put(`${O}/auth/UpdateUser`,l,{headers:{"Content-Type":"application/json"},withCredentials:!0});console.log(r,"edit user "),r.status===200&&(ee(r.data.message),R(-1))}catch(r){console.error(r),c(((d=(n=r==null?void 0:r.response)==null?void 0:n.data)==null?void 0:d.message)||"Failed to update user. Please try again.")}finally{I(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(Z,{}),e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-200 p-4 mt-20",children:e.jsxs("div",{className:"w-full max-w-[80%] bg-white rounded-lg shadow-md p-6",children:[e.jsx("div",{className:"text-center",children:e.jsx("h3",{className:"text-3xl font-semibold text-red-500",children:"Edit User"})}),e.jsxs("form",{onSubmit:V,className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Name"}),e.jsx("input",{type:"text",value:j,onChange:s=>f(s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Email"}),e.jsx("input",{type:"email",value:y,onChange:s=>b(s.target.value),className:"input-field",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Contact"}),e.jsx("input",{type:"text",value:v,onChange:s=>N(s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Area"}),e.jsx("input",{type:"text",value:w,onChange:s=>o(s.target.value),className:"input-field",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Pincode"}),e.jsx("input",{type:"text",value:C,onChange:Q,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"City"}),e.jsx("input",{type:"text",value:k,onChange:s=>u(s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"State"}),e.jsx("input",{type:"text",value:A,onChange:s=>m(s.target.value),className:"input-field",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium",children:"Country"}),e.jsx("input",{type:"text",value:D,onChange:s=>g(s.target.value),className:"input-field",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Select Business Categories:"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx("div",{className:"input-field cursor-pointer",onClick:J,children:x.length>0?e.jsx("span",{className:"capitalize",children:x}):e.jsx("span",{className:"text-gray-400",children:"Select a category"})}),$&&e.jsx("ul",{className:"absolute z-10 border border-gray-300 bg-white w-full mt-2 rounded-md max-h-40 overflow-y-auto shadow-lg",children:z.map((s,i)=>e.jsx("li",{className:`cursor-pointer capitalize px-4 py-2 hover:bg-green-200 ${x===s.categoryName?"bg-green-200":""}`,onClick:()=>K(s.categoryName),children:s.categoryName},i))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Business Address"}),e.jsx("input",{type:"text",value:E,onChange:s=>P(s.target.value),className:"input-field",required:!0})]})]}),e.jsx("div",{children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Business Details"}),e.jsx("input",{type:"text",value:B,onChange:s=>U(s.target.value),className:"input-field"})]})}),e.jsx("button",{type:"submit",className:`w-full py-2 rounded-md text-white font-bold ${p?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,disabled:p,children:p?"Updating...":"Edit User"})]})]})})]})};export{ae as default};
