import{r as d,j as e,c as y,B as h,M as A,U as S,d as B,u as P,A as F,e as E,P as I,f as D,g as L,L as R,h as Y,i as $,k as U}from"./index-CLFYgmIb.js";import{s as k,a as w}from"./startSilver-5oWuoMuE.js";import{C as O}from"./CurrentLocation-C9YpufQ9.js";const z="https://ees121.com",H=()=>{const[s,b]=d.useState(null),[i,u]=d.useState(null),c=JSON.parse(localStorage.getItem("token")),[x,l]=d.useState(!1),g=p=>{const n=p.target.files[0];b(n),u(URL.createObjectURL(n))},j=async p=>{if(p.preventDefault(),!s){alert("Please upload an image");return}const n=new FormData;n.append("banner",s),console.log("FormData:",Object.fromEntries(n));try{l(!0);const m=await y.post(`${z}/banner/addBanner`,n,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${c}`}});h("Banner Added Successfully"),window.location.reload(),b(null),u(null)}catch(m){console.error("Error details:",m),h(m.response.data.message)}finally{l(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("form",{onSubmit:j,className:"flex flex-col items-center gap-4 p-4 border border-gray-300 rounded-lg shadow-md bg-white",children:[e.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer flex items-center justify-center w-full max-w-xs h-24 border-2 border-dashed border-orange-500 text-orange-600 font-semibold rounded-lg hover:bg-orange-50 transition",children:"Add Offer Banner"}),e.jsx("input",{type:"file",id:"file-upload",name:"banner",onChange:g,className:"hidden"}),i&&e.jsx("img",{src:i,alt:"Preview",className:"w-48 h-auto rounded-md shadow-sm"}),e.jsx("button",{type:"submit",className:"bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition disabled:opacity-50",disabled:x,children:x?e.jsx("div",{className:"spinner-border text-white w-5 h-5 animate-spin",role:"status"}):"Add"})]})})},C="https://ees121.com",K=()=>{const[s,b]=d.useState([]),[i,u]=d.useState(null),c=JSON.parse(localStorage.getItem("token")),[x,l]=d.useState(!1);if(!c)return e.jsx("div",{children:"You must be logged in to view banners."});const g=async()=>{l(!0);try{const n=await y.get(`${C}/banner/getBanners`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}});if(n.status===200){const m=n.data;b(m.banners)}}catch(n){u("Error fetching banners. Please try again later."),console.error("Error fetching banners:",n)}finally{l(!1)}},j=async n=>{h.info(e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to delete this Banner?"}),e.jsxs("div",{className:"d-flex justify-content-center gap-2",children:[e.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>p(n),children:"Yes"}),e.jsx("button",{className:"btn btn-secondary btn-sm",onClick:h.dismiss,children:"No"})]})]}),{autoClose:!0,closeOnClick:!0})},p=async n=>{h.dismiss();try{(await y.delete(`${C}/banner/deleteBanner`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},data:{bannerId:n}})).status===200&&(console.log("Banner deleted successfully"),g())}catch(m){u("Error deleting banner. Please try again later."),console.error("Error deleting banner:",m)}finally{l(!1)}};return d.useEffect(()=>{g()},[]),e.jsx("section",{className:"mt-3",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"col-12 d-flex flex-wrap",children:[i&&e.jsx("div",{className:"alert alert-danger",children:i}),s.length>0?s.map((n,m)=>e.jsx("div",{className:"col-md-4 p-1",children:e.jsxs("div",{className:"card card-banners h-100 w-100 overflow-hidden",children:[e.jsx("div",{className:"img-banner",style:{height:"100%"},children:e.jsx("img",{src:n.imageUrl,className:"card-img-top overflow-hidden img-fluid",style:{objectFit:"cover",height:"100%"},alt:n.description||"Banner"})}),e.jsx("div",{className:"banner-Btn",children:e.jsx("button",{className:"btn bg-orange text-white fs-4 p-2",onClick:()=>j(n._id),disabled:x,children:x?e.jsx("div",{className:"spinner-border text-white",role:"status",children:e.jsx("span",{className:"sr-only",children:"Loading..."})}):e.jsx(A,{})})})]})},m)):e.jsx("div",{children:"No banners available."})]})})})})},T="https://ees121.com",_=({onClose:s,onSubmit:b})=>{const[i,u]=d.useState(1),[c,x]=d.useState({bankAccountNumber:"",ifscCode:"",accountHolderName:""}),[l,g]=d.useState({bankProof:null,panCardfront:null,panCardback:null,frontAadhar:null,backAadhar:null}),[j,p]=d.useState({bankProof:null,panCardfront:null,panCardback:null,frontAadhar:null,backAadhar:null}),n=(t,o)=>{const r=t.target.files[0];if(r){if(r.size>2*1024*1024){h.error("File size should not exceed 2MB.");return}g(N=>({...N,[o]:r})),p(N=>({...N,[o]:URL.createObjectURL(r)}))}},m=[{name:"Bank Proof",field:"bankProof"},{name:"PAN Front",field:"panCardfront"},{name:"PAN Back",field:"panCardback"},{name:"Aadhar Front",field:"frontAadhar"},{name:"Aadhar Back",field:"backAadhar"}],v=async()=>{if(!l.bankProof||!l.panCardfront||!l.panCardback||!l.frontAadhar||!l.backAadhar){h.error("Please upload all required documents.");return}const t=new FormData;t.append("bankProof",l.bankProof),t.append("panCardfront",l.panCardfront),t.append("panCardback",l.panCardback),t.append("frontAadhar",l.frontAadhar),t.append("backAadhar",l.backAadhar),t.append("bankAccountNumber",c.bankAccountNumber),t.append("accountHolderName",c.accountHolderName),t.append("ifscCode",c.ifscCode);try{const o=await y.post(`${T}/withdrawal/addkyc`,t,{withCredentials:!0});console.log(o.data,"response.data"),o.status===201?(h.success("KYC details submitted successfully!"),b(),s(),window.location.reload()):h.error("Submission failed. Try again.")}catch(o){console.error("Error:",o),h.error("Something went wrong!")}},a=()=>{h.dismiss(),v()},f=()=>{h.info(e.jsxs("div",{children:[e.jsx("p",{children:"Are you sure you want to submit?"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:"10px"},children:[e.jsx("button",{onClick:a,style:{color:"green",border:"none",background:"transparent",cursor:"pointer"},children:"Yes"}),e.jsx("button",{onClick:()=>h.dismiss(),style:{color:"red",border:"none",background:"transparent",cursor:"pointer"},children:"No"})]})]}),{autoClose:!1})};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 p-5 z-50",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-lg shadow-lg p-6 relative",children:[e.jsx("button",{className:"absolute top-2 right-4 bg-gray-200 hover:bg-gray-300 rounded-full p-2",onClick:s,children:"âœ•"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:i===1?"Enter Bank Details":"Upload Documents"}),i===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Account Holder Name",e.jsx("input",{type:"text",value:c.accountHolderName,onChange:t=>x({...c,accountHolderName:t.target.value}),className:"w-full p-2 border rounded mt-1"})]}),e.jsxs("label",{className:"block text-gray-700 font-medium",children:["Bank Account Number",e.jsx("input",{type:"text",value:c.bankAccountNumber,onChange:t=>x({...c,bankAccountNumber:t.target.value}),className:"w-full p-2 border rounded mt-1"})]}),e.jsxs("label",{className:"block text-gray-700 font-medium",children:["IFSC Code",e.jsx("input",{type:"text",value:c.ifscCode,onChange:t=>x({...c,ifscCode:t.target.value}),className:"w-full p-2 border rounded mt-1"})]})]}),i===2&&e.jsx("div",{className:"grid grid-cols-2 gap-4",children:m.map(({name:t,field:o})=>e.jsxs("label",{className:"block text-gray-700 font-medium ",children:[t,e.jsxs("div",{className:"mt-1 w-full border-2 border-dashed border-gray-300 p-4 rounded-lg flex flex-col items-center cursor-pointer hover:border-blue-500 transition relative",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:r=>n(r,o),className:"hidden",id:o}),e.jsx("label",{htmlFor:o,className:"flex flex-col items-center text-gray-500 cursor-pointer",children:j[o]?e.jsx("img",{src:j[o],alt:t,className:"w-24 h-24 object-cover rounded-lg"}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"text-2xl mb-2 text-gray-400"}),e.jsx("span",{className:"text-sm",children:"Click to upload"})]})})]})]},o))}),e.jsxs("div",{className:"flex justify-between mt-4",children:[i>1&&e.jsx("button",{className:"p-2 bg-gray-400 rounded",onClick:()=>u(i-1),children:"Back"}),i<2?e.jsx("button",{className:"p-2 bg-blue-600 text-white rounded",onClick:()=>u(i+1),children:"Next"}):e.jsx("button",{className:"p-2 bg-green-600 text-white rounded",onClick:f,children:"Submit"})]})]})})},G=()=>{const{user:s}=d.useContext(S);console.log(s,"user---------------------------------");const[b,i]=d.useState(!1),u=B(),[c,x]=d.useState(!1),[l,g]=d.useState(null),j=P(),p=`${window.location.origin}/register?referralCode=${s==null?void 0:s._id}`;d.useEffect(()=>{if(u.hash==="#kyc-section"){const a=document.getElementById("kyc-section");a&&a.scrollIntoView({behavior:"smooth"})}},[u]);const n=()=>{navigator.clipboard.writeText(p),i(!0),setTimeout(()=>i(!1),2e3)},m=(a=[],f=10)=>{const t=a.length>0?a.reduce((r,N)=>r+N,0)/a.length:0,o=[];for(let r=1;r<=f;r++)o.push(e.jsx("img",{src:r<=t?k:w,alt:r<=t?"Filled Star":"Empty Star",width:15},r));return o},v=(a=[],f=10)=>{const t=a.length>0?a.reduce((r,N)=>r+N,0)/a.length:0,o=[];for(let r=1;r<=f;r++)o.push(e.jsx("img",{src:r<=t?k:w,alt:r<=t?"Filled Star":"Empty Star",width:15},r));return o};return e.jsxs(e.Fragment,{children:[e.jsx(F,{}),e.jsx(E,{}),e.jsx(I,{}),e.jsxs("div",{className:"my-24",children:[e.jsx("section",{className:"",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row",children:e.jsxs("div",{className:"w-full bg-white p-6 rounded-lg shadow-md",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("img",{className:"w-full h-[200px] object-cover rounded-md",src:"https://img.freepik.com/free-vector/colorful-watercolor-texture-background_1035-19319.jpg?ga=GA1.1.897959581.1731651336&semt=ais_hybrid",alt:"Banner"}),e.jsx("div",{className:"absolute bottom-[-70px] right-14 w-[200px] h-[200px] rounded-full border-4 border-white ring-4 ring-orange-500 shadow-lg overflow-hidden",children:e.jsx("img",{src:s.profilePic,alt:"Profile",className:"w-full h-full object-cover"})})]}),e.jsxs("div",{className:"px-3 md:px-5",children:[e.jsxs("div",{className:"mt-24 md:mt-8 text-left sm:text-left",children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-700",children:s==null?void 0:s.name}),s!=null&&s.profilePic?null:e.jsx("p",{className:"text-orange text-sm",children:"You haven't set a profile picture yet."}),e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{className:"text-sm",children:"User Rating:"}),(s==null?void 0:s.userRatings)&&e.jsxs("div",{className:"flex items-center",children:[v(s==null?void 0:s.userRatings.map(a=>a.rating),10),e.jsxs("span",{className:"pl-2",children:[s==null?void 0:s.userAverageRating,".0"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("strong",{className:"text-sm",children:"Provider Rating:"}),(s==null?void 0:s.providerRatings)&&e.jsxs("div",{className:"flex items-center",children:[m(s==null?void 0:s.providerRatings.map(a=>a.rating),10),e.jsxs("span",{className:"pl-2",children:[s==null?void 0:s.providerAverageRating,".0"]})]})]})]}),e.jsxs("div",{className:"mt-4 text-gray-700 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",s==null?void 0:s.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," +91",s==null?void 0:s.phone]}),e.jsx(O,{user:s})]})]}),e.jsxs("div",{className:"mt-6 bg-gray-100 p-4 rounded-md",children:[e.jsx("p",{className:"text-gray-600 font-medium",children:"Your Referral Link:"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-blue-600 font-medium truncate",children:p}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-blue-500",children:b?e.jsx(D,{size:20}):e.jsx(L,{size:20})}),e.jsx(R,{to:`whatsapp://send?text=${p}`,className:"text-white bg-orange text-sm p-2 rounded-md flex items-center",children:e.jsx(Y,{size:16})})]}),b&&e.jsx("p",{className:"text-green-500 text-sm",children:"Copied!"})]}),e.jsxs("div",{id:"kyc-section",className:"mt-6 bg-gray-100 p-6 rounded-lg shadow-sm",children:[e.jsx("h3",{className:"text-2xl font-semibold text-gray-700 mb-4",children:"KYC Details"}),s.ekyc?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Account Holder Name:"})," ",s.ekyc.accountHolderName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bank Account Number:"})," ",s.ekyc.bankAccountNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"IFSC Code:"})," ",s.ekyc.ifscCode]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," â‚¹",s.ekyc.amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{className:`ml-2 text-sm ${s.ekyc.status==="pending"?"text-gray-600":"text-green-600"}`,children:s.ekyc.status==="pending"?"Pending (Your KYC Details are waiting for admin's approval)":s.ekyc.status})]})]}),e.jsx("div",{className:"mt-5 grid grid-cols-1 sm:grid-cols-3 gap-6 text-center",children:[{label:"Bank Proof",src:s.ekyc.bankProof},{label:"PAN Card (Front)",src:s.ekyc.panCardfront},{label:"PAN Card (Back)",src:s.ekyc.panCardback}].map((a,f)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:a.src,alt:a.label,className:"w-[200px] rounded-md shadow-sm cursor-pointer",onClick:()=>g(a.src)}),e.jsx("p",{className:"mt-2 text-md font-medium",children:a.label})]},f))})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("p",{className:"text-gray-600",children:"KYC details not uploaded yet."}),e.jsx("button",{onClick:()=>x(!0),className:"mt-3 bg-orange text-white py-2 px-4 rounded-md font-semibold hover:bg-orange-600 transition",children:"Complete KYC"})]}),l&&e.jsx("div",{className:"fixed inset-0 flex justify-center items-center bg-black bg-opacity-75 z-50",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"absolute top-2 right-2 bg-red-500 text-white px-2 py-1 rounded-full",onClick:()=>g(null),children:"âœ•"}),e.jsx("img",{src:l,alt:"Preview",className:"max-w-full max-h-[90vh] rounded-lg shadow-lg cursor-pointer"})]})}),e.jsx("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-6 text-center",children:[{label:"Aadhaar Front",src:s==null?void 0:s.frontAadhar},{label:"Aadhaar Back",src:s==null?void 0:s.backAadhar}].map((a,f)=>e.jsx("div",{className:"flex flex-col items-center",children:a.src?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:a.src,alt:a.label,className:"w-[200px] rounded-md shadow-sm cursor-pointer",onClick:()=>g(a.src)}),e.jsx("p",{className:"mt-2 text-md font-medium",children:a.label})]}):e.jsxs("p",{className:"text-gray-600",children:["No ",a.label," uploaded"]})},f))})]}),c&&e.jsx(_,{onClose:()=>x(!1),onSubmit:()=>{x(!1)}}),e.jsxs("div",{className:"mt-4",children:[(s==null?void 0:s.userId)&&e.jsxs("p",{className:"text-gray-600 font-medium",children:["Unique ID:"," ",e.jsxs("span",{className:"text-gray-800 font-semibold",children:["EES121-",s==null?void 0:s.userId]})]}),e.jsxs("p",{className:"text-gray-600 font-medium",children:["Business Category:"," ",e.jsx("span",{className:"text-gray-800 font-semibold",children:s==null?void 0:s.businessCategory})]}),e.jsxs("p",{className:"text-gray-600 font-medium",children:["Business Details:"," ",e.jsx("span",{className:"text-gray-800 font-semibold",children:s==null?void 0:s.businessDetaile})]}),e.jsxs("p",{className:"text-gray-600 font-medium",children:["Business Address:"," ",e.jsx("span",{className:"text-gray-800 font-semibold",children:s==null?void 0:s.businessAddress})]}),e.jsxs("div",{className:"py-3",children:[e.jsxs("span",{className:"text-gray-600 font-medium",children:["Status:"," "]}),e.jsx("span",{className:`font-semibold ${(s==null?void 0:s.userstatus)==="available"?"text-green-600":"text-red-600"}`,children:s==null?void 0:s.userstatus})]})]}),e.jsx("div",{className:"mt-6 flex justify-center sm:justify-end",children:e.jsx("button",{onClick:()=>j("/editprofile",{state:s}),className:"bg-orange text-white py-2 px-4 rounded-full font-semibold uppercase text-sm",children:"Edit Profile"})}),e.jsx("div",{className:"mt-6",children:e.jsx(H,{})})]})]})})})}),e.jsx(K,{})]}),e.jsx($,{})]})};export{G as default};
